!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %link{:href => "//fonts.googleapis.com/css?family=Pirata+One", :rel=> "stylesheet", :type => "text/css"}/



.wrapper
  %input#view{:name => "view", :style => "display:none;", :type => "checkbox"}/
  %label{:for => "view"}
.banner
  #text SCAN KINGDOM
  %form#form1{:runat => "server"}
  %input#imgInp{:accept => "image/*", :type => "file"}/
%img#imgParse.pic{:src => "#", :width => "400px"}/

:coffeescript
    $ ->
        connection = new WebSocket('wss://cool-media-rpranav.c9users.io:8081')
        # When the connection is open, send some data to the server

        connection.onopen = ->
            console.log 'Wizard Connected'
            return
        
        # Log errors
        
        connection.onerror = (error) ->
            console.log 'WebSocket Error ' + error
            return
        
        # Log messages from the server
        
        connection.onmessage = (e) ->
            console.log "Pinging!"
            message = JSON.parse(e.data)
            console.log 'Message type: ' + message.type
            
        getBase64Image = (img) ->
          # Create an empty canvas element
          canvas = document.createElement('canvas')
          canvas.width = img.width
          canvas.height = img.height
          # Copy the image contents to the canvas
          ctx = canvas.getContext('2d')
          ctx.drawImage img, 0, 0
          # Get the data-URL formatted image
          # Firefox supports PNG and JPEG. You could check img.src to guess the
          # original format, but be aware the using "image/jpg" will re-encode the image.
          imgToSend = $("#imgParse").src
          dataURL = canvas.toDataURL(imgToSend)
          dataURL
          
        sendImage = ->
          img = getBase64Image(document.getElementById('image'))
          JSONimg = 
            'type': 'img'
            'data': img
          ws.send JSON.stringify(JSONimg)
          return


:scss
    #imgInp {
        position: absolute;
        margin-top: -90px;
        font-size: 3em;
        opacity: 0;
    }

    @keyframes shakeIt {
      0% {
        -webkit-transform: rotate(0deg);
        -ms-transform: rotate(0deg);
        -o-transform: rotate(0deg);
        transform: rotate(0deg);
      }
    
      100% {
        -webkit-transform: rotate(360deg);
        -ms-transform: rotate(360deg);
        -o-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    
    @keyframes buzz {
      0% {
        transform: rotate(7deg);
      }
    
      100% {
        transform: rotateZ(-7deg);
      }
    }
    
    #text {
        font-family: 'Tangerine', serif;
        
        margin-top: 5px;
        margin-right: 16px;
        background-color: transparent;

        text-align: center;
        justify-content: center;
        align-items: center;
        display: inline-block;
 
        font-size: 30px;
        outline: none;
        cursor: pointer;
        pointer-events:none;
        padding: 8px;
        width: 70%;
        height: 50%;
        border-radius: 5px;

        color: #ff912d;
        
        text-shadow: -1px 2px 0 #a86526, 0 0px #929090, 2px 0 #a86526, 0 0px #929090;
        text-decoration: none;
        letter-spacing: 3px;
        transition: all 0.3s ease-out;
        
        line-height: 90%;
        
        -webkit-text-stroke-width: 0px;
        -webkit-text-stroke-color: #a86526;
        
        font-weight: 580;
        margin-left: 45px;
        margin-top: 30px;
    }
    body {
      margin: 0;
      padding: 0;
      background-image: url("/assets/back2.png");
      background-position: 0px -50px;

      color: white;
      opacity: 0.9;
      font-family: 'PT Sans', sans-serif;
      background-repeat: no-repeat;
      background-size: cover;
      position: relative;
      top: 350px;
      left: 5px;

    }
    .pic {
        width: 280px;
        height: 390px;
        // background: black;
        // opacity: .5;
        position: absolute;
        top: -255px;
        left: 45px;
        z-index: 1;
        // border:none;
    }
    
    .banner {
        width: 380px;
        height: 200px;
        background-image: url("/assets/ban.png");
        background-size: cover;
        background-color: transparent;
        position: absolute;
        top: -258px;
        left: 10px;
        z-index: 3;
        background-size: 350px 145px;
        
        background-repeat: no-repeat;
        z-index: 3;
    }
    .wrapper {
      margin: 0 auto;
      max-width: 1140px;
      text-align: center;
      padding-top: 70px;
      position: relative;
      z-index: 2;

    }
    
    label[for=view] {

      display: inline-block;
     
      font-size: 32px;
      
      transition: 0.15s ease-in-out;
      cursor: pointer;
      user-select: none;
      animation-play-state: paused;
      animation: buzz .7s ease-in-out 0s infinite alternate-reverse;
      
      background: rgba(0,0,0,.5);

      background-image: url("/assets/icon.png");

      border: 10px solid rgba(112, 104, 99, .7); 
      border-radius: 50%;
      
      width: 150px;
      height: 150px;

      
      
      background-size: cover;
      background-repeat: no-repeat;
      &:hover {
        box-shadow: 0px 2px 0px rgba(0, 0, 0, 0.25);
      }
    }
   
    
    #view:checked + label[for=view] {
      background-color: transparent;
      background-color: rgba(0, 0, 0, .3);
      box-shadow: 2px 5px 5px rgba(0, 0, 0, 0.4);
      background-image: url("/assets/sword3.png");
      
      transition: 0.25s cubic-bezier(0.25, 2.38, 0.91, 1.19);
      animation: shakeIt 3s ease-in-out 0s infinite;
      
      background-repeat: no-repeat;
      background-size: 130px 130px;
      background-position: center; 
        
    }
   
:javascript
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      
      reader.onload = function (e) {
      $('#imgParse').attr('src', e.target.result);
      // $("#text").text("SCANNING");
      $(".banner").css("display", "none");
      $("#view").prop('checked', true);
     // getTransfer(reader.result);
    }
		
    reader.readAsDataURL(input.files[0]);
    }
  }

  $("#imgInp").change(function(){
    readURL(this);
  });

   